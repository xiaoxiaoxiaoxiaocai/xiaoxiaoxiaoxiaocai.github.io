

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="xiaocai">
  <meta name="keywords" content="">
  
    <meta name="description" content="火锅链观光打卡签到题 Power Trajectory Diagram下载得到attachment.npz文件，发现有四部分数据，通过查看 input 和 index 后可以知道题目是一共爆破了13个字符，每个字符爆破了40次，然后每次爆破都会有一条 trace写一个 python 脚本读取 trace 数据并画折线图，发现每条 trace 都会有一个最小值 1234567891011121314">
<meta property="og:type" content="article">
<meta property="og:title" content="ciscn 2024">
<meta property="og:url" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/index.html">
<meta property="og:site_name" content="xiaocai">
<meta property="og:description" content="火锅链观光打卡签到题 Power Trajectory Diagram下载得到attachment.npz文件，发现有四部分数据，通过查看 input 和 index 后可以知道题目是一共爆破了13个字符，每个字符爆破了40次，然后每次爆破都会有一条 trace写一个 python 脚本读取 trace 数据并画折线图，发现每条 trace 都会有一个最小值 1234567891011121314">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20140652.png">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20142156.png">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20114652.png">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20113925.png">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20133424.png">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20132137.png">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20132047.png">
<meta property="og:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20134226.png">
<meta property="article:published_time" content="2024-05-27T02:40:45.000Z">
<meta property="article:modified_time" content="2024-05-28T06:22:42.083Z">
<meta property="article:author" content="xiaocai">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20140652.png">
  
  
  
  <title>ciscn 2024 - xiaocai</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xiaoxiaoxiaoxiaocai.github.io.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Xiaocai&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/wallhaven-d6v3jo_1920x1080.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ciscn 2024"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-05-27 10:40" pubdate>
          May 27, 2024 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          5.8k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          49 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ciscn 2024</h1>
            
            
              <div class="markdown-body">
                
                <h3 id="火锅链观光打卡"><a href="#火锅链观光打卡" class="headerlink" title="火锅链观光打卡"></a>火锅链观光打卡</h3><p>签到题</p>
<h3 id="Power-Trajectory-Diagram"><a href="#Power-Trajectory-Diagram" class="headerlink" title="Power Trajectory Diagram"></a>Power Trajectory Diagram</h3><p>下载得到attachment.npz文件，发现有四部分数据，通过查看 input 和 index 后可以知道<br>题目是一共爆破了13个字符，每个字符爆破了40次，然后每次爆破都会有一条 trace<br>写一个 python 脚本读取 trace 数据并画折线图，发现每条 trace 都会有一个最小值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs py"><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br>data = np.load(<span class="hljs-string">&#x27;attachment.npz&#x27;</span>)<br><br>trace = data[<span class="hljs-string">&#x27;trace&#x27;</span>]<br><span class="hljs-built_in">input</span> = data[<span class="hljs-string">&#x27;input&#x27;</span>]<br><br><span class="hljs-comment"># print(input) 十三组打印字符串，每组字符串个数是40个，一共5200个字符串</span><br><br>index = data[<span class="hljs-string">&#x27;index&#x27;</span>]<br><br><span class="hljs-comment"># print(index) 内容是1-12.</span><br><br><span class="hljs-comment"># print(trace) 520个数组，每个数组应该是功耗变化值，对应input的字符，其中每组变化最大的就是密码中的字符</span><br><br>num_groups = <span class="hljs-number">13</span> <br>group_size = <span class="hljs-number">40</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>    res = []<br>    table = <span class="hljs-built_in">input</span>[:<span class="hljs-number">40</span>]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>        <span class="hljs-built_in">min</span> = np.argmin(trace[i*<span class="hljs-number">40</span>+j])<br>        res.append(<span class="hljs-built_in">min</span>)<br>        <span class="hljs-comment"># print(res) 提取res中最大值来确定爆破字符的index</span><br>    index = np.argmax(res)<br>    char = table[index]<br>    <span class="hljs-built_in">print</span>(char,end=<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-comment">#_ciscn_2024_</span><br><br><br></code></pre></td></tr></table></figure>


<h3 id="神秘文件"><a href="#神秘文件" class="headerlink" title="神秘文件"></a>神秘文件</h3><p>太难找了<br>part3 运用了宏编辑<br>alt+f11打开宏编辑页面<br><img src="/2024/05/27/ciscn-2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20140652.png" srcset="/img/loading.gif" lazyload alt="alt text"><br>然后 base64 的RC4 解码 然后base64<br><img src="/2024/05/27/ciscn-2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20142156.png" srcset="/img/loading.gif" lazyload alt="alt text"></p>
<h3 id="通风机"><a href="#通风机" class="headerlink" title="通风机"></a>通风机</h3><p>STEP7 MicroWIN V4.0 SP9 软件打开然后在 symbol table 中发现 base64 编码后的 flag，CyberChef 解码即可得到 flag</p>
<h3 id="Tough-DNS"><a href="#Tough-DNS" class="headerlink" title="Tough_DNS"></a>Tough_DNS</h3><p>题目内容：DNS的世界充满了多变的字符，接下来我将直接给你答案：56 16 26 93 66 53 16 56 d2 03 26 93 56<br>题目给了一个DNS流量包，发现有的包中有二进制数据，导出</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs py">tshark -r <span class="hljs-number">1.</span>pcapng -T fields -e dns.qry.name | sed <span class="hljs-string">&#x27;/^\s*$/d&#x27;</span> | uniq &gt; <span class="hljs-number">1.</span>txt<br></code></pre></td></tr></table></figure>
<p>然后将其转为二维码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-comment"># 新建一个列表来保存奇数行</span><br>odd_lines = []<br><br><span class="hljs-comment"># 打开文件并读取行</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> index, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(file):<br>        <span class="hljs-comment"># 如果行号是奇数（索引是偶数），则保留该行</span><br>        <span class="hljs-keyword">if</span> index % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            odd_lines.append(line.strip())<br><br><span class="hljs-comment"># 将处理后的奇数行合并为一个字符串</span><br>s = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> odd_lines:<br>    s +=line  <span class="hljs-comment"># 使用 += 运算符来拼接字符串</span><br><br><span class="hljs-comment"># 然后继续按照原逻辑处理字符串s</span><br>MAX = <span class="hljs-number">21</span><br>i = <span class="hljs-number">0</span><br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, (MAX, MAX))<br><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, MAX):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, MAX):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(s) &gt; i:  <span class="hljs-comment"># 确保索引没有超出字符串s的长度</span><br>            <span class="hljs-keyword">if</span> s[i] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>                pic.putpixel((x, y), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>            <span class="hljs-keyword">else</span>:<br>                pic.putpixel((x, y), (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))<br>        i += <span class="hljs-number">1</span><br><br>pic.save(<span class="hljs-string">&#x27;fl.png&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>扫码得到<br>15f9792dba5c<br>明显不是flag，继续看流量包，发现txt解析记录将其提取出来</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs py">tshark.exe -r Tough_DNS.pcapng -T fields -e dns.txt -Y <span class="hljs-string">&quot;(dns.txt.length == 1) &amp;&amp; (dns.id == 0x4500)&quot;</span>|tr -d <span class="hljs-string">&quot;\n&quot;</span> &gt;&gt;<span class="hljs-number">2.</span>txt<br> <br>tshark.exe -r Tough_DNS.pcapng -T fields -e dns.txt -Y <span class="hljs-string">&quot;(dns.txt.length == 1) &amp;&amp; (dns.id == 0x6421)&quot;</span>|tr -d <span class="hljs-string">&quot;\n&quot;</span> &gt;&gt;<span class="hljs-number">3.</span>txt<br></code></pre></td></tr></table></figure>
<p>得到两个文件，2.条txt文件发现是一个zip，那么猜测二维码扫出来的是密码。</p>
<p><img src="/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20114652.png" srcset="/img/loading.gif" lazyload alt="alt text"></p>
<p>得到secret.gpg</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs py">-----BEGIN PGP PRIVATE KEY BLOCK-----<br>Version: GnuPG v1<br><br>lQIGBGR0mdUBBACYjdQSFv/9VkDcH406ee9a01IpIYv2tJkTu4WuEzh3cb52B+vT<br>FRbgC3MMohKL41potPMTVM6U4cisg0gTPnQeIk37R5A47g03gPRJxO6SBrolsM7W<br>ibfPpqT2dyQnsW8xfU7gxoiPoDQ16OeJzzM8GFhMbkNccBOOETgo9yTTOwARAQAB<br>/gcDArSnU3JKy53PYEuZt6Ur4DafWuUXztAfuzKkNwJCwhE9xGFGSWlo4whjOhzy<br>JaUGRL2ToiihW1JPlkvW59/my2X5DuvblMnMDilMYVzQzHcg0C0rVRpD97FNeZJG<br>ZfQnzQomF1a4/kz5jc1IpmMAxKLjJjkptXcI6vf72Hb9Rs07lrOYmBE2dc8OC8Wj<br>P/2vsAhHUxywWAQEG4ATXklAvBdipERfCU4aHW2GMsvlV1ncnp0MBuXjQeqCWt7i<br>9RYgIkvptZWl2Y8AtK5NsXZ0kZvKv/4GxJUZ5tmRep3YEbBlK2EihqLxALiPvMd+<br>yUmYnht5SZB67ZwbnwBwAdKLTvV03Rm8ZoTeg+EzLBXH7kj0Pl4/pnXiKvDgCS/<span class="hljs-number">6</span><br>IwP4h0sIx1H/<span class="hljs-number">4</span>/8AkJ/ivrOxPhm+FZ15ct64x54Ae27Hy7zjHwkCu5MMQ1smbQ/e<br>WbArOtJHJ6hKWI/CuA+0EBEQNNBUetx0dub+vazAyaQB1h8VXw7Y9aq0HmN0ZmVy<br>IChub25lKSA8Y3RmZXJAZ21haWwuY29tPoi4BBMBAgAiBQJkdJnVAhsDBgsJCAcD<br>AgYVCAIJCgsEFgIDAQIeAQIXgAAKCRDNNPbFh+VSkJjJBACFSEjtR6BQg3MCkrpt<br>9vwW9Opb1BXBrUKUD5z4od2enZwOPw/fRaiC2npr+DiGQ4XyIQzwsyn6Gx62h1UQ<br>SgGk4MLy/9ffEIYJHJAgU+ouEu+OWsk+VUJND5dHimIxyePgjHm+7NTr6CgFnflN<br>Oe2PeqmsOEcRNDSk5LNQ/L9UQJ0CBgRkdJnVAQQA4my1wcQGuuJ6dKxg62QBFy7W<br>N/cJnnWm0W0l/3LWDfRZq/Lk1wMmp9hBj16yRoh9EBvgQCz1de2Rx6TjvvOVUw0j<br>LyumHVIzetbjnQbMHWA1xLXSarDu9u3ZT2zwXV/vo4VukIlDIEayOshVrmk9VOMf<br>bngf//aDmRwsgj6ZIQMAEQEAAf4HAwK0p1NySsudz2C4Whqn6GQ8PMIyoqV8Y94u<br>p9+Qq34FiOgquLqetKoNNaG2M5KJJB77W9Yzt8dM0A09wCpObA9mTCW0SI4N6MJF<br>OdvY6jpG844uHI6L2IKMFZQTdDwvfgMPpGjLHM7/ho3dpec9BKDihQDeCrWl3tfy<br>WAh68pHPXYyMmTu51iGfkNCEv+SEHlqq0PsLbGT9DxwDWGPzCzvjpY79Uv1cS5Iw<br>IwI6aaccUjsoobvdqD8HJY2B4JGj1XY2oHrZDPH/OwgPMwArbHtHqgd632BxN9Of<br>l0sNzas41LB731RUcP79M7wWQPIbhx61ubIZPtejqa/P5u0gRpFKyHo6tW9t/al5<br>OL9F2vFhl63Hm1Us6XScduWZM9pmd3tEwarHVsBt4z+BIgJJKDvKWs9dgw2aQhKp<br>rwNKErMUfhiVuw0uTJBS2F4JsPjKdF7hp3mk7wiVGloCy0+c4l0EL+U/9N1EGD7y<br>K2NKDZFB4i1srW2aiJ8EGAECAAkFAmR0mdUCGwwACgkQzTT2xYflUpBfEwP+I1x7<br>DspB3GnQAFvXVtkmpi1ASEMQtbCMgexx4+PuqbbUNKOFr83mBkzCQkuh5lrHEZfp<br>vKN/A1X8AvCxxZu/m9rS8nZQ/BNt7qAG6DjBXrWycWn2swYtMIzys/CsKkhg33hO<br>iHcehkCXX0Jd8TmE664iLs1WUVHzXK/v5h4XA1o=<br>=Izki<br>-----END PGP PRIVATE KEY BLOCK-----<br></code></pre></td></tr></table></figure>
<p>可以看出是一个pgp加密的公钥，那另一个是密文了，将其转为16进制导出。</p>
<p>然后题目给的是私钥了：56 16 26 93 66 53 16 56 d2 03 26 93 56<br>将其反转并转ascii</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br><br><span class="hljs-comment"># for item in printable:</span><br><span class="hljs-comment">#     print(ord(item), end=&#x27; &#x27;)</span><br><span class="hljs-comment"># 48 49 50 51 52 53 54 55 56 57 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 58 59 60 61 62 63 64 91 92 93 94 95 96 123 124 125 126 32 9 10 13 11 12</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    passwd = <span class="hljs-string">&#x27;&#x27;</span><br>    enc_passwds = [<span class="hljs-string">&#x27;56&#x27;</span>, <span class="hljs-string">&#x27;16&#x27;</span>, <span class="hljs-string">&#x27;26&#x27;</span>, <span class="hljs-string">&#x27;93&#x27;</span>, <span class="hljs-string">&#x27;66&#x27;</span>, <span class="hljs-string">&#x27;53&#x27;</span>,<br>                   <span class="hljs-string">&#x27;16&#x27;</span>, <span class="hljs-string">&#x27;56&#x27;</span>, <span class="hljs-string">&#x27;d2&#x27;</span>, <span class="hljs-string">&#x27;03&#x27;</span>, <span class="hljs-string">&#x27;26&#x27;</span>, <span class="hljs-string">&#x27;93&#x27;</span>, <span class="hljs-string">&#x27;56&#x27;</span>]<br>    <span class="hljs-comment"># for item in enc_passwds:</span><br>    <span class="hljs-comment">#     print(int(item, 16), end=&quot; &quot;)</span><br>    <span class="hljs-comment"># # 86 22 38 147 102 83 22 86 210 3 38 147 86</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> enc_passwds:<br>        item = item[::-<span class="hljs-number">1</span>]<br>        <span class="hljs-comment"># print(int(item,16),end=&quot; &quot;)</span><br>        <span class="hljs-comment"># 101 97 98 57 102 53 97 101 45 48 98 57 101</span><br>        passwd += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(item, <span class="hljs-number">16</span>))<br>    <span class="hljs-keyword">return</span> passwd<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    passwd = solve()<br>    <span class="hljs-built_in">print</span>(passwd)<br><span class="hljs-comment"># eab9f5ae-0b9e</span><br></code></pre></td></tr></table></figure>
<p>然后进行解码即可得到flag</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs py">gpg --<span class="hljs-keyword">import</span> secret.gpg<br>gpg: /root/.gnupg/trustdb.gpg：建立了信任度数据库<br>gpg: 密钥 CD34F6C587E55290：公钥 “ctfer (none) &lt;ctfer@gmail.com&gt;” 已导入<br>gpg: 密钥 CD34F6C587E55290：私钥已导入<br>gpg: 处理的总数：<span class="hljs-number">1</span><br>gpg:               已导入：<span class="hljs-number">1</span><br>gpg:       读取的私钥：<span class="hljs-number">1</span><br>gpg:   导入的私钥：<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs py"> gpg -d out.txt<br>gpg: 由 <span class="hljs-number">1024</span> 位的 RSA 密钥加密，标识为 51457644D5D8B1B5，生成于 <span class="hljs-number">2023</span>-05-<span class="hljs-number">29</span><br>      “ctfer (none) &lt;ctfer@gmail.com&gt;”<br>flag&#123;79830a47-faf7-<span class="hljs-number">4067</span>-b585-145776f833cd&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20113925.png" srcset="/img/loading.gif" lazyload alt="alt text"></p>
<h3 id="盗版软件"><a href="#盗版软件" class="headerlink" title="盗版软件"></a>盗版软件</h3><p>得到一个exe文件和一个dmp文件，运行exe文件后得到一张图片，发现其上方有点<br><img src="/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20133424.png" srcset="/img/loading.gif" lazyload alt="alt text"><br>在全红是可以看出有zip，但是中间有垃圾数据，提取</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br><br>res = []<br>i = <span class="hljs-number">8</span><br><span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(data):<br>    res.append(data[i])<br>    i += <span class="hljs-number">2</span><br><span class="hljs-comment"># print(res)</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.zip&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-built_in">bytes</span>(res))<br></code></pre></td></tr></table></figure>
<p>得到一个.b文件，进行base85解码<br><img src="/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20132137.png" srcset="/img/loading.gif" lazyload alt="alt text"><br>然后在云沙箱运行<br><a target="_blank" rel="noopener" href="https://s.threatbook.com/report/file/a97946c34d2d8642820f196a54a6e8d78cf4f58a97e417be9696d7fd19e7fc95">https://s.threatbook.com/report/file/a97946c34d2d8642820f196a54a6e8d78cf4f58a97e417be9696d7fd19e7fc95</a></p>
<p><img src="/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20132047.png" srcset="/img/loading.gif" lazyload alt="alt text"><br>得到 IP : 39.100.72.235<br>但是dmp用vol提取不出来东西，使用010，utf-8编码<br><img src="/2024/05/27/ciscn-2024/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-05-28%20134226.png" srcset="/img/loading.gif" lazyload alt="alt text"><br>得到 winhack.com</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Misc/" class="category-chain-item">Misc</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ciscn 2024</div>
      <div>http://xiaoxiaoxiaoxiaocai.github.io.com/2024/05/27/ciscn-2024/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>xiaocai</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>May 27, 2024</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/05/15/%E5%87%BA%E9%A2%98%E8%AE%B0%E5%BD%95/" title="出题记录">
                        <span class="hidden-mobile">出题记录</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
